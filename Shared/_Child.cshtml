<!DOCTYPE html>
<html>
<head>
    <title>@ViewBag.Title</title>
    <link rel="shortcut icon" href="@Url.Content("~/Content/logo.ico")"/>
    <link href="@Url.Content("~/Content/themes/xlgwr/xlgwr.all.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/Areas/XlgwrCordiality/Content/XlgwrCordiality.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/Content/themes/redmond/jquery.ui.all.css")" rel="stylesheet" type="text/css" />
    <script src="@Url.Content("~/Scripts/jquery-1.6.4.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery-ui-1.8.14.custom.min.js")" type="text/javascript"> </script>
    <script type="text/javascript">
        $(function () {
            //theme switcher
            $(document).each(function () {
                var linktheme = $(parent.document).find('link[title="theme"]').first().attr("href");
                //alert(linktheme.toString());
                $('link[title="theme"]').replaceWith('<link href="' + linktheme + '" title="theme" rel="Stylesheet" type="text/css" />');
                $('iframe').each(function () {
                    var thissrc = $(this).attr("src");
                    $(this).attr("src", thissrc);
                });
                /////////////////////datetime
                $("input[name='送货日期'],input[name='交货日期']").datepicker({ minDate: 0, maxDate: "+6M +10D" })
            });
        });
    </script>
    <script type="text/javascript">
        $(function () {
            var titles = "";
            //////////////////////////////////////////////////////////////////////////
            $("input:button").button();
            $("input:submit").button();
            $(".loadmessage").hide();
            //////////////////////////////////////////////////////////////////////////
            $("#dialog_tools,#dialog_Create,#dialog_select").dialog({
                autoOpen: false,
                zIndex: 3999,
                buttons: {
                    "   确  定  ": function () {
                        $(this).dialog("close");
                        //           location.href = "/XlgwrCordiality/ProductionSchedule/CreateProcessInspection";
                        //           location = location;
                        //            window.location.reload();
                        //            location.reload();
                    }
                },
                open: function (event, ui) {
                    var $dialog = $(this);
                    // 最大化,最小化,图标修改处
                    var atext = $(".ui-dialog-titlebar-close").replaceWith('<p class="ui-xlgwr"><span class="ui-icon ui-icon-minusthick">minusthick</span> <span class="ui-icon ui-icon-extlink">extlink</span><span class="ui-icon ui-icon-closethick">close</span></p>');
                    //最大化,最小化事件
                    $(".ui-xlgwr>span").click(function () {
                        var spantext = $(this).text();
                        //alert("ok:ui-span" + spantext);
                        //最大化
                        if (spantext == "extlink") {

                            if (window.screen) {              //判断浏览器是否支持window.screen判断浏览器是否支持screen
                                var myw = screen.availWidth;   //定义一个myw，接受到当前全屏的宽
                                var myh = screen.availHeight;  //定义一个myw，接受到当前全屏的高
                                //window.moveTo(0, 0);           //把window放在左上脚
                                //window.resizeTo(myw, myh);     //把当前窗体的长宽跳转为myw和myh
                                $dialog.dialog({
                                    position: ['left', 'top'],
                                    width: myw * 0.8,
                                    height: myh * 0.8
                                });

                            } else {
                                $dialog.dialog({
                                    position: 'center',
                                    width: 800,
                                    height: 600
                                });
                            }

                            //最小化
                        } else if (spantext == "minusthick") {
                            $dialog.dialog({
                                position: 'top',
                                width: 210,
                                height: 210
                            });
                            //退出
                        } else if (spantext == "close") {
                            $dialog.dialog("close");
                        } else {
                            alert("请选择正确的图标,谢谢.");
                        }
                    });
                },
                close: function () {

                    //$("#dialogtools").text("加载中...");
                    $(".loadmessage").hide();
                }
            });
            //////////////////////////////////////////////////////////////////////////
            ///////////////////////////////刷选/////////////////////////////////////
            $("#btnSelect").click(function () {
                var selectKey2 = $("#intext").val().toString();
                var hrefsSelect = $("#dialogselect").attr("src-data").toString() + selectKey2.toString();
                //iframe加载src
                $("#dialogselect").attr("src", hrefsSelect);
                $("#dialog_select").dialog("option", "title", titles + productid.toString());

            });
            //////////////////////////////////////////////////////////////////////////
            /****//加载要选择的对象.如：客户ＩＤ，调用该客户的相关信息//*****/
            $(".selecticon").click(function () {

                //alert("ok");

                // alert(likeText.toString());

                //获取class 的值
                var flag = $(this).attr("class")//.hasClass('WOPID');
                //alert(flag.toString());

                var hrefs = "";
                var titles = "";
                //面页转换,进入的面不同
                if (flag == "selecticon PC ui-icon ui-icon-search") {
                    // alert("flag:productid PI");
                    titles = "客户资料->客户代号Like->"
                    hrefs = "/XlgwrCordiality/ProductInformation/GetProductCustomerInformationById/";
                } else if (flag == "selecticon MA ui-icon ui-icon-search") {
                    //alert("flag:productid MA");
                    titles = "供应商资料->厂商代号Like->"
                    hrefs = "/XlgwrCordiality/VendorsManagement/GetPageVendorsInformationByIdChild/";
                }else if (flag == "selecticon PI ui-icon ui-icon-search") {
                    // alert("flag:productid PI");
                    titles = "产品资料->产品代号Like->"
                    hrefs = "/XlgwrCordiality/ProductInformation/GetSelectProductInformationById/";
                } else if (flag == "selecticon WOPID") {
                    titles = "工单详细资料->工单单号Like->"
                    hrefs = "/XlgwrCordiality/ProductionSchedule/EditProcessInspection/";
                } else {
                    alert("选择错误.icon child");
                }
                //获取ID号 //获取输入input的值
                var productid = $(this).parent().find('input:eq(0)').val();

                // alert(productid.toString());

                if (productid == "") {
                    titles += "前N条记录,请输入要筛选的数据.谢谢.";
                }
                //var productid = $(this).text().toString();
                //连接href
                var Id = hrefs + productid.toString();

                //alert(Id.toString());
                //打开新窗口

                var $dialotShow = $("#dialog_select").dialog();
                var $dialotiframe = $("#dialogselect");
                //alert("Ok");
                //.attr("datasrc").toString();
                $dialotShow.dialog("open");
                $dialotShow.dialog({
                    width: 520,
                    height: 320
                });
                //iframe
                $dialotiframe.attr("src-data", hrefs.toString());

                $dialotiframe.attr("src", Id.toString());

                $dialotShow.dialog("option", "title", titles + productid.toString());


            });
            //////////////////////////////////////////////////////////////////////////
        });
    </script>
</head>
<body class="ui-widget-content none" style="min-height: 200px!important;">
    <div class="ui-widget-content none">
        @RenderBody()
    </div>
    <div class="loadmessage">
        加载中...
    </div>
    @* ////加载要选择的对象.如：客户ＩＤ，调用该客户的相关信息///*@
    <div id="dialog_select">
        <div class="searchdiv">
            <b id="searchTitle" class="none ui-widget-content">代号(或名称):</b>
            <input id="intext" class="ui-widget-content" type="text" />
            <input id="btnSelect" type="button" value="筛 选" />
        </div>
        <hr />
        <iframe id="dialogselect" class="left" frameborder="0" src-data="">加载中...</iframe>
    </div>
    <div id="dialog_tools">
        <iframe id="dialogtools" frameborder="0" src-data="">加载中...</iframe>
    </div>
    <div id="dialog_Create" class="relative">
        <div id="dialogCreate" class="relative">
            <div id="selectcontent">
                加载中...</div>
        </div>
    </div>
</body>
</html>
