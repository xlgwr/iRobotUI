<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/cshtml; charset=utf-8" />
    <title>@ViewBag.Title</title>
    <link href="@Url.Content("~/Content/themes/xlgwr/xlgwr.all.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/Areas/XlgwrCordiality/Content/XlgwrCordiality.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/Content/themes/redmond/jquery.ui.all.css")" title="theme" rel="stylesheet" type="text/css" />
    <script src="@Url.Content("~/Scripts/jquery-1.6.4.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery-ui-1.8.14.custom.min.js")" type="text/javascript"> </script>
    <script src="../../../../Scripts/jquery-1.6.4.min.js" language="javascript" type="text/javascript"></script>
    <script src="../../../../Scripts/jquery-ui-1.8.14.custom.min.js" language="javascript"
        type="text/javascript"></script>
    <script type="text/javascript">
        $(function () {
            //theme switcher
            var linktheme = $(parent.document).find('link[title="theme"]').first().attr("href");
            //alert(linktheme.toString());
            $('link[title="theme"]').replaceWith('<link href="' + linktheme + '" title="theme" rel="Stylesheet" type="text/css" />');
            $('iframe').each(function () {
                var thissrc = $(this).attr("src");
                $(this).attr("src", thissrc);
            });
        });
    </script>
    <script type="text/javascript">

        $(function () {
            //////////////////////////////////////////////////////////////////////////
            $(".each").each(function () {
                var textval = $(this).val();
                if (textval.length > 0) {
                    $(this).attr("disabled", "disabled");
                }

            });
            //////////////////////////////////////////////////////////////////////////
            $(".Productnumber").dblclick(function () {
                //alert("ok");
                var a = $(this).val();
                if (a.length > 0) {
                    var id = $(this).attr("name").toString();
                    $(this).attr("disabled", "disabled");
                    id = "/XlgwrCordiality/ProductionSchedule/SaveStratOrEndTimeprocessInspectionDetailsDetails/" + id.toString() + "^" + a
                    // alert(id.toString());
                    $.ajax({
                        url: id.toString(),
                        success: function (data) {
                            if (data.toString() == "保存成功") {
                                alert(data.toString());
                            } else {
                                alert(data.toString());
                                window.close();
                                window.open("#");
                            }

                        }
                    });
                    ///
                } else {
                    alert("请输入正确的数量.谢谢!");
                    $(this).focus();
                }


            });
            ////////////////////////////////////////////////////////////////////////
            $(".starttime").click(function () {
                var a = new Date();
                a = a.getFullYear() + "-" + (a.getMonth() + 1) + "-" + a.getDate() + " " + a.getHours() + ":" + a.getMinutes() + ":" + a.getSeconds();
                $(this).val(a);
                var id = $(this).attr("name").toString();
                $(this).attr("disabled", "disabled");
                id = "/XlgwrCordiality/ProductionSchedule/SaveStratOrEndTimeprocessInspectionDetailsDetails/" + id.toString() + "^" + a
                // alert(id.toString());
                $.ajax({
                    url: id.toString(),
                    success: function (data) {
                        if (data.toString() == "保存成功") {

                            alert(data.toString());
                        } else {
                            alert(data.toString());
                            window.close();
                            window.open("#");

                        }


                    }
                });

            });
            ///////////////////////////////////////////////////////////////////
            //endtime
            $(".endtime").click(function () {
                var a = new Date();
                a = a.getFullYear() + "-" + (a.getMonth() + 1) + "-" + a.getDate() + " " + a.getHours() + ":" + a.getMinutes() + ":" + a.getSeconds();
                $(this).val(a);
                var id = $(this).attr("name").toString();
                $(this).attr("disabled", "disabled");
                id = "/XlgwrCordiality/ProductionSchedule/SaveStratOrEndTimeprocessInspectionDetailsDetails/" + id.toString() + "^" + a
                // alert(id.toString());
                $.ajax({
                    url: id.toString(),
                    success: function (data) {
                        if (data.toString() == "保存成功") {
                            alert(data.toString());
                        } else {
                            alert(data.toString());
                            window.close();
                            window.open("#");
                        }

                    }
                });
                ///

            });
        });
   
   
    </script>
    <script type="text/javascript">

        $(function () {
            //////////////////////////////////////////////////////////////////////////////
            var $tabs = $("#tabsdetails").tabs({
                select: function (event, ui) {
                    var $iframe = $(ui.panel).find('iframe:eq(0)'); //获取当前iframe
                    var iframeDataSrc = $iframe.attr("data-src"); //获取当前iframe的url
                    var iframeSrc = $iframe.attr("flag"); //是否点过,0:无,1:点过
                    //////////
                    //alert("Tab:tabsdetails---" + ui.index.toString() + "---Datasrc:---" + iframeDataSrc.toString() + "---src:--" + iframeSrc.toString());
                    //////////
                    if (iframeSrc.toString() == "0") {
                        // alert("you was click once.");
                        $iframe.attr("flag", "1"); //改变点击记录
                        $iframe.attr("src", iframeDataSrc.toString()); //进入iframe的src
                    }
                    //////////
                }
            });
            //////////////////////////////////////////////////////////////////////////////  
            //////////////////////////////////////////////////////////////////////////

        });
   
   
    </script>
    <script type="text/javascript">

        $(function () {
            //变量

            var titles = "";
            //////////////////////////////////////////////////////////////////////////
            $("input:button").button();
            //////////////////////////////////////////////////////////////////////////
            $("#dialog_tools,#dialog_Create,#dialog_select").dialog({
                autoOpen: false,
                zIndex: 3999,
                buttons: {
                    "   确  定  ": function () {
                        $(this).dialog("close");
                        //           location.href = "/XlgwrCordiality/ProductionSchedule/CreateProcessInspection";
                        //           location = location;
                        //            window.location.reload();
                        //            location.reload();
                    }
                },
                open: function (event, ui) {
                    var $dialog = $(this);
                    // 最大化,最小化,图标修改处
                    var atext = $(".ui-dialog-titlebar-close").replaceWith('<p class="ui-xlgwr"><span class="ui-icon ui-icon-minusthick">minusthick</span> <span class="ui-icon ui-icon-extlink">extlink</span><span class="ui-icon ui-icon-closethick">close</span></p>');
                    //最大化,最小化事件
                    $(".ui-xlgwr>span").click(function () {
                        var spantext = $(this).text();
                        //alert("ok:ui-span" + spantext);
                        //最大化
                        if (spantext == "extlink") {

                            if (window.screen) {              //判断浏览器是否支持window.screen判断浏览器是否支持screen
                                var myw = screen.availWidth;   //定义一个myw，接受到当前全屏的宽
                                var myh = screen.availHeight;  //定义一个myw，接受到当前全屏的高
                                //window.moveTo(0, 0);           //把window放在左上脚
                                //window.resizeTo(myw, myh);     //把当前窗体的长宽跳转为myw和myh
                                $dialog.dialog({
                                    position: ['left', 'top'],
                                    width: myw * 0.8,
                                    height: myh * 0.8
                                });

                            } else {
                                $dialog.dialog({
                                    position: 'center',
                                    width: 800,
                                    height: 600
                                });
                            }

                            //最小化
                        } else if (spantext == "minusthick") {
                            $dialog.dialog({
                                position: 'top',
                                width: 500,
                                height: 210
                            });
                            //退出
                        } else if (spantext == "close") {
                            $dialog.dialog("close");
                        } else {
                            alert("请选择正确的图标,谢谢.");
                        }
                    });
                },
                close: function () {

                    //$("#dialogtools").text("加载中...");
                    $(".loadmessage").hide();
                }
            });
            //////////////////////////////////////////////////////////////////////////
            // ***************************************新增工单单号
            //            $("#getnew").click(function () {
            //                $.ajax({
            //                    url: "/XlgwrCordiality/ProductionSchedule/SetUpWorkOrderInformationmodel",
            //                    success: function (data) {
            //                        //alert("ok:getnew");
            //                        location.href = "/XlgwrCordiality/ProductionSchedule/CreateProcessInspection";
            //                    }
            //                });
            //            });
            //////////////////////////////////////////////////////////////////////////
            // ***************************************工单单号
            $("#getid").click(function () {
                //alert("getid:ok");
                //alert("ok"); 
                var selectkey = $('input[name$="工单单号"]').val().toString();
                var Id = "/XlgwrCordiality/ProductionSchedule/GetWorkOrderInformation/" + selectkey;
                //alert(Id.toString()); $("#dialog_tools").dialog("open");
                //                $("#dialog_tools").dialog("open");

                //$("#intext").val(selectkey);
                $("#dialog_tools").dialog("open");

                $(".loadmessage").fadeIn('slow');

                $("#dialogtools").attr("src", Id.toString());


            });
            ///////////////////////////////刷选/////////////////////////////////////
            $("#btnSelect").click(function () {
                var selectKey2 = $("#intext").val().toString();
                var hrefsSelect = $("#dialogselect").attr("src-data").toString() + selectKey2.toString();
                //iframe加载src
                $("#dialogselect").attr("src", hrefsSelect);
                $("#dialog_select").dialog("option", "title", titles + productid.toString());

            });
            //////////////////////////////////////////////////////////////////////////
            /****//加载要选择的对象.如：客户ＩＤ，调用该客户的相关信息//*****/
            $(".selecticon").click(function () {

                //alert("ok");

                // alert(likeText.toString());

                //获取class 的值
                var flag = $(this).attr("class")//.hasClass('WOPID');
                //alert(flag.toString());

                var hrefs = "";
                var titles = "";
                //面页转换,进入的面不同
                if (flag == "selecticon PC ui-icon ui-icon-search") {
                    // alert("flag:productid PI");
                    titles = "客户资料->客户代号Like->"
                    hrefs = "/XlgwrCordiality/ProductInformation/GetProductCustomerInformationById/";
                } else if (flag == "selecticon MA ui-icon ui-icon-search") {
                    // alert("flag:productid PI");
                    titles = "供应商资料->厂商代号Like->"
                    hrefs = "/XlgwrCordiality/VendorsManagement/GetPageVendorsInformationByIdChild/";
                } else if (flag == "selecticon WOPID") {
                    titles = "工单详细资料->工单单号Like->"
                    hrefs = "/XlgwrCordiality/ProductionSchedule/EditProcessInspection/";
                } else {
                    alert("选择错误.icon diaglogchild");
                }
                //获取ID号 //获取输入input的值
                var productid = $(this).parent().find('input:eq(0)').val();

                // alert(productid.toString());

                if (productid == "") {
                    titles += "前N条记录,请输入要筛选的数据.谢谢.";
                }
                //var productid = $(this).text().toString();
                //连接href
                var Id = hrefs + productid.toString();

                //alert(Id.toString());
                //打开新窗口
                $("#dialog_select").dialog({
                    width: 515,
                    height: 520
                });
                $("#dialog_select").dialog("open");
                //iframe
                $("#dialogselect").attr("src-data", hrefs.toString());

                $("#dialogselect").attr("src", Id.toString());
                //endiframe
                $("#dialog_select").dialog("option", "title", titles + productid.toString());


            });
            //////////////////////////////////////////////////////////////////////////
            ////////////////////////////////////////////////////////////////////////// 
            /****点对应的ID,DialogTools,加载不一样的url*****/
            $(".productid").click(function () {

                //alert("ok");

                //获取class 的值
                var flag = $(this).attr("class")//.hasClass('WOPID');
                //alert(flag.toString());



                //面页转换,进入的面不同
                if (flag == "productid PI") {
                    // alert("flag:productid PI");
                    titles = "产品详细资料--->产品代号--->"
                    hrefs = "/XlgwrCordiality/ProductInformation/Details/";
                } else if (flag == "productid OI") {
                    titles = "订单资料资料--->订单单号--->"
                    hrefs = "/XlgwrCordiality/OrderManagement/Details/";
                }  else if (flag == "productid WOPID") {
                    titles = "工单详细资料--->工单单号--->"
                    hrefs = "/XlgwrCordiality/ProductionSchedule/EditProcessInspection/";
                }else {
                    alert("选择错误.productid");
                }
                //获取ID号
                var productid = $(this).text().toString();
                //连接href
                var Id = hrefs + productid;
                //alert(Id.toString());
                //打开新窗口
                $("#dialog_tools").dialog({
                    width: 855,
                    height: 680
                });
                //.attr("datasrc").toString();
                $("#dialog_tools").dialog("open");
                //iframe
                $("#dialogtools").attr("src-data", hrefs.toString());

                $("#dialogtools").attr("src", Id.toString());

                $("#dialog_tools").dialog("option", "title", titles + productid);


            });
            //////////////////////////////////////////////////////////////////////////
            //*************************************************
            $(".tabs-up,").tabs();
            $("input:submit").button();
            //$(".submittop :submit").button({ disabled: true });
            $('#ChangedTs,#CreatedTs,.time').datepicker({
                autoSize: true,
                changeMonth: true,
                changeYear: true,
                showWeek: true,
                minDate: new Date(2000, 1 - 1, 1),
                maxDate: 0
            });
            //***********************************************
            //////////////////////////////////////////////////////////////////////////

            $('.DataItem tr:gt(0)').click(function () {
                //alert("click tr");
                var checked = $(this).find(":checkbox").attr("checked");
                //alert(checked);
                if (checked == "checked") {
                    $(this).removeClass("click");
                    $(this).find(':checkbox').removeAttr("checked");


                } else {
                    $('.DataItem tr:gt(0) :checkbox').removeAttr("checked");
                    $('.DataItem tr:gt(0)').removeClass("click");
                    $(this).find(':checkbox').attr("checked", "checked");
                    $(this).toggleClass();
                    //////////////////////////////////////////////////////id
                    var id = $(this).find(':checkbox').val();

                    //var WOI = $(this).find(':checkbox').hasClass('WOI');
                    //alert(id.toString());
                    ///
                    //获取class 的值
                    var flag = $(this).find(':checkbox').attr("class")//.hasClass('WOPID');
                    //alert(flag.toString());
                    //面页转换,修改值,进入的面不同
                    if (flag == "PC") {
                        //alert("ok");
                        $.ajax({
                            url: "/XlgwrCordiality/ProductInformation/SelectCustomerInformationViewModel/" + id.toString(),
                            success: function (data) {
                                // alert("选择工单:" + id.toString() + " 成功...");
                                // location.href = "/XlgwrCordiality/ProductionSchedule/CreateProcessInspection";
                            }
                        });
                    } else if (flag == "selectPI") {

                        $(parent.document).find("#tools-1-tr-1-i").attr("data-id", id.toString());

                    } else if (flag == "WOI") {
                        //alert("ok");
                        $.ajax({
                            url: "/XlgwrCordiality/ProductionSchedule/SelectWorkOrderInformationmodel/" + id.toString(),
                            success: function (data) {
                                // alert("选择工单:" + id.toString() + " 成功...");
                                // location.href = "/XlgwrCordiality/ProductionSchedule/CreateProcessInspection";
                            }
                        });
                    } else {
                        //alert("选择错误.dialog");
                    }

                    ///

                }
                $(this).toggleClass("click");


            });
            //***********************************************
            //////////////////////////////////////////////////////////////////////////
            //            $('.DataItem tr:gt(0)').dblclick(function () {
            //                alert("dbclick tr");
            //                $(this).dialog("close");
            //                
            //            });

            //////////////////////////////////////////////////////////////////////////
            $(".loadmessage").hide();
            ///**********************
            $(".pages").click(function () {
                $(".loadmessage").fadeIn();
                var loadhref = $(this).attr("href-data");
                //alert("OK" + loadhref.toString());
                //                $("#powerAccording").load(loadhref.toString(),
                //                                              function (response, status, xhr) {
                //                                                  if (status == "error") {
                //                                                      var msg = "Sorry but there was an error: ";
                //                                                      alert(msg + xhr.status + " " + xhr.statusText);
                //                                                  }
                //                                                  $(".loadmessage").fadeOut('slow');
                //                                                  $(".loadmessage").hide();
                //                                              });
                location.href = loadhref.toString();
                $(".loadmessage").fadeOut('slow');
                $(".loadmessage").hide();

            });

            //////////////////////////////////////////////////////////////////////////
            //*********************************************

        })
        
    </script>
</head>
<body class="ui-widget-content none" style="height:680px; overflow:hidden;">
    <div id="pagebody">
        <div id="main" class="leftmain">
        <br />
            <div class="searchdiv">
                <b id="searchTitleindex" class="none ui-widget-content">代号(或名称):</b>
                <input id="intextSearch" class="hone ui-widget-content"  style="font-size:large!important; font-weight:bold!important;"  type="text" />
                <input id="btnSelectSearch" type="button" value="筛 选" />
            </div>
        <br />
            @*<hr class="centerhr" />*@
            <!--nav_pt_n_content引用其它页面-->
            @RenderBody()
        </div>
    </div>
    <div id="footer">
        <div class="loadmessage">
            加载中...
        </div>
        <div id="dialog_tools">
            <iframe id="dialogtools" frameborder="0" src-data="">加载中...</iframe>
            @*   @{Html.RenderAction("GetWorkOrderInformation", new { id = "01" });}*@
        </div>
        @* ////加载要选择的对象.如：客户ＩＤ，调用该客户的相关信息///*@
        <div id="dialog_select">
            <div class="searchdiv">
                <b id="searchTitle" class="none ui-widget-content">代号(或名称):</b>
                <input id="intext" class="ui-widget-content" type="text" />
                <input id="btnSelect" type="button" value="筛 选" />
            </div>
            <hr />
            <iframe id="dialogselect" class="left" frameborder="0" src-data="">加载中...</iframe>
            @*   @{Html.RenderAction("GetWorkOrderInformation", new { id = "01" });}*@
        </div>
        <div id="dialog_Create" class="relative">
            <div id="dialogCreate" class="relative">
                <div id="selectcontent">
                    加载中...</div>
            </div>
        </div>
    </div>
</body>
</html>
